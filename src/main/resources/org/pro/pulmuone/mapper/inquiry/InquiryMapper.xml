<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="org.pro.pulmuone.mapper.inquiry.InquiryMapper">

	<!-- // 문의 목록
	ArrayList<InquiryDTO> select (String user_id, String category) throws SQLException; -->
	<select id="select" resultType="org.pro.pulmuone.domain.inquiry.InquiryDTO">
	<!-- 	SELECT b.*
		FROM (
			SELECT ROWNUM no, t.*
			FROM (
				SELECT q_no, faq_no, question, answer
				FROM faq
				WHERE REGEXP_LIKE ( question, #{param3}, 'i' )
				ORDER BY q_no DESC
			) t
		) b
		WHERE b.no BETWEEN (#{param1}-1) * #{param2} + 1 AND ((#{param1}-1) * #{param2}) + #{param2} -->
		
		SELECT *
		FROM inquiry
		WHERE member_id = #{param1}
		<if test="category != 'all' ">
			AND inquiry_cate = #{param2}
		</if>		
		ORDER BY inquiry_no DESC
		
	</select>	

	<!-- // 문의 작성
	int write (InquiryDTO dto) throws SQLException; -->
	<insert id="write">
		INSERT INTO inquiry
				( inquiry_no, member_id, inquiry_cate, email, title, content)
		VALUES (seq_inquiry.NEXTVAL, #{member_id}, #{inquiry_cate}, #{email}, #{title}, #{content})
	</insert>

	<!-- // 문의 갯수 
	int selectCount ( String user_id, String category) throws SQLException; -->
	<select id="selectCount" resultType="int">
		SELECT COUNT(*)
		FROM inquiry
		WHERE member_id = #{param1}		
		<if test="category != 'all' ">
			AND inquiry_cate = #{param2}
		</if>
	</select>
	
	<!-- // 문의 상세보기
	InquiryDTO view (String user_id, String category, int seq) throws SQLException; -->
	<select id="view" resultType="org.pro.pulmuone.domain.inquiry.InquiryDTO">
		SELECT *
		FROM inquiry
		WHERE member_id = #{param1}
		AND inquiry_cate = #{param2}
		AND inquiry_no = #{param3}
	</select>
	
	<!-- // 문의 삭제
	int delete (String user_id, String category, int seq) throws SQLException; -->
    <delete id="delete">
    	DELETE FROM inquiry
		WHERE member_id = #{param1}
		AND inquiry_cate = #{param2}
		AND inquiry_no = #{param3}
    </delete> 
    
</mapper>

